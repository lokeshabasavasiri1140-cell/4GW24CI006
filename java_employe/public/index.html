<!DOCTYPE html>
<html>
<head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"></head>
<body class="p-4 bg-light">
    <div class="container bg-white p-4 shadow rounded">
        <h3>Employee Registration</h3>
        <div class="row g-2 mb-4">
            <div class="col-md-3"><input id="n" class="form-control" placeholder="Name"></div>
            <div class="col-md-3"><input id="e" class="form-control" placeholder="Email"></div>
            <div class="col-md-2"><input id="ph" class="form-control" placeholder="Phone"></div>
            <div class="col-md-2"><select id="g" class="form-select"><option>Male</option><option>Female</option></select></div>
            <div class="col-md-2"><input id="d" class="form-control" placeholder="Dept"></div>
            <button class="btn btn-success mt-2" onclick="add()">Save Permanently</button>
        </div>
        <table class="table table-striped mt-4">
            <thead class="table-dark"><tr><th>Name</th><th>Dept</th><th>Daily Update</th></tr></thead>
            <tbody id="list"></tbody>
        </table>
        <button class="btn btn-info" onclick="location.href='logs.html'">View All Logs</button>
    </div>
    <script>
        async function load() {
            const res = await fetch('/api/employees');
            const data = await res.json();
            document.getElementById('list').innerHTML = data.map(emp => `
                <tr><td>${emp.name}</td><td>${emp.dept}</td>
                <td><button class="btn btn-sm btn-success" onclick="log('${emp.name}','Login')">In</button>
                <button class="btn btn-sm btn-danger" onclick="log('${emp.name}','Logout')">Out</button></td></tr>`).join('');
        }
        async function add() {
            await fetch('/api/employees', {method:'POST', headers:{'Content-Type':'application/json'}, 
                body: JSON.stringify({name:n.value, email:e.value, phone:ph.value, gender:g.value, dept:d.value})});
            location.reload();
        }
        async function log(name, status) {
            await fetch('/api/log', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({name, status})});
            alert(status + " Recorded for " + name);
        }
        load();
    </script>
</body>
</html>